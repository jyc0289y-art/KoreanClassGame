# 실제 지리 기반 서울/후쿠오카 맵 오버홀 + 차량 시스템

## Context
현재 서울(9600×7200) 및 후쿠오카(6400×4800) 통합맵은 실제 지리와 큰 차이가 있다. 한강은 단순 수평 밴드이고, 도로망은 20여 개 미만이며, 남산/북한산/아차산/뚝섬/탄천/여의도 등 핵심 지형이 누락되어 있다. 건물이 도로 위에 배치되는 비현실적 문제도 있다. 사용자는 실제 지도를 참조한 정확한 지리 복원, 주요 랜드마크 배치, 그리고 레벨 기반 차량 이동 시스템을 요구한다.

## 결정 사항
- **서울 맵 크기**: 9600×7200 → **14400×10800** 확장 (~400px/km, 36km×27km)
- **후쿠오카 맵 크기**: 6400×4800 → **9600×7200** 확장 (비례, ~640px/km)
- **차량 친구(서울)**: **김유석** (AI 앱 개발자)
- **해금 레벨**: 셀프 드라이브 **Lv.6** / 쇼퍼(김유석 운전) **Lv.10**
- **후쿠오카**: 아빠 차 — 동일 레벨 기준 적용
- **청크 사이즈**: 2400px 유지 (14400÷2400=6, 10800÷2400=4.5→5 = 30청크)

## 핵심 수정 파일

| 파일 | 변경 범위 |
|------|-----------|
| `src/scenes/seoul/SeoulUnifiedScene.js` | **전면 재작성** — 지형/도로/건물/다리/랜드마크 전체 |
| `src/scenes/fukuoka/FukuokaUnifiedScene.js` | **전면 재작성** — 지형/도로/건물/다리/랜드마크 전체 |
| `src/scenes/BaseWorldScene.js` | 차량 호출 UI, 드라이브맵 오버레이, 건물-도로 충돌 방지 |
| `src/constants.js` | 차량 시스템 상수, 맵 사이즈 변경 (14400×10800, 9600×7200) |
| `src/systems/GameState.js` | 차량 상태 저장/로드 |
| `docs/20260301_XXXX_*.md` | 작업계획서 문서 |

---

## Phase 1: 서울 지형 오버홀 (한강 S-커브 + 산/하천/섬)

### 1A. 한강 실제 S-커브 복원

현재 한강은 Y:3560~4200 직선 밴드. 실제 한강은 서→동으로 S자 커브를 그린다.

**실제 지리 → 픽셀 매핑** (14400×10800, ~400px/km):

한강 중심선 북안 좌표 (서→동, 약 20개 포인트):
```
(0, 5000) → (1000, 4900) → (2000, 5100) → 여의도 북쪽
(3000, 5300) → 여의도 남서
(3800, 5200) → 마포/용산
(4800, 4900) → 한남대교 (북쪽으로 올라감)
(5800, 4800) → 압구정
(6800, 5000) → 성수대교
(7800, 5200) → 뚝섬/영동대교
(8800, 5400) → 청담/잠실
(10000, 5500) → 잠실대교
(11000, 5400) → 올림픽대교 동쪽
(12000, 5300) → (13000, 5200) → (14400, 5100) → 동쪽 출구
```
남안 = 북안 Y + 450~500px (하폭)
은행(bank): 양쪽 25px

### 1B. 여의도 섬 복원
- 한강 내 섬으로 렌더링 (물 위에 녹지+도시 구역)
- 위치: (2600, 5000)~(4200, 5700), 한강에 둘러싸임
- 여의도 주변 한강 분류 (섬 위/아래로 물이 갈라짐)
- 주요 시설: 국회의사당, IFC, 63빌딩, 여의도공원, KBS

### 1C. 산악 지형
| 지형 | 위치 (px) | 크기 | 컬러/특징 |
|------|-----------|------|-----------|
| 북한산 | (3500, 0)~(8000, 1200) | 4500×1200 | 진녹 0x1a4a1a, 그래디언트 |
| 남산 | (6200, 3400)~(7600, 4600) | 1400×1200 | 녹색 원형 구릉 + N서울타워 |
| 아차산 | (12500, 1800)~(14400, 4800) | 1900×3000 | 녹색 능선 |
| 인왕산/북악산 | (4500, 900)~(6800, 2200) | 2300×1300 | 도심 뒤편 능선 |
| 관악산 | (4000, 9000)~(6000, 10800) | 2000×1800 | 남쪽 산지 |

### 1D. 하천
| 하천 | 경로 | 폭 |
|------|------|-----|
| 탄천 | (9200, 8700)→(9400, 5500) 한강 합류 | 100px |
| 중랑천 | (10500, 1200)→(10800, 5200) 한강 합류 | 100px |
| 양재천 | (6800, 9000)→(9000, 6500) 탄천 합류 | 60px |
| 청계천 | (5800, 2500)→(10500, 3000) 중랑천 합류 | 40px (복원 하천) |
| 안양천 | (2500, 8000)→(2200, 5400) 한강 합류 (서쪽) | 80px |

---

## Phase 2: 서울 도로망 복원 (14400×10800 스케일)

### 2A. 고속도로/간선도로 (major, 180px)
| 도로명 | 경로 설명 | 특징 |
|--------|-----------|------|
| 강변북로 | 한강 북안 곡선 따라 서→동 (한강 Y-200) | 한강 커브를 따르는 곡선 도로 |
| 올림픽대로 | 한강 남안 곡선 따라 서→동 (한강 Y+500) | 동일하게 곡선 |
| 내부순환로 | 도심 루프 (북→동→남→서) | 4개 구간으로 분할 렌더링 |
| 경부고속도로 | 강남 (X:7000) 남북 관통 | 서초→양재→과천 방향 |

### 2B. 주요 도로 (major 160px / medium 100px)
| 도로명 | 방향 | 약 위치 (px) | 타입 |
|--------|------|-------------|------|
| 종로 | E-W | Y:2800, X:4500~10000 | major |
| 세종대로 | N-S | X:5800, Y:2000~4500 | major |
| 을지로 | E-W | Y:3200, X:5000~10000 | medium |
| 퇴계로 | E-W | Y:3600, X:5000~10000 | medium |
| 강남대로 | N-S | X:7000, Y:5800~9000 | major |
| 테헤란로 | E-W | Y:6800, X:6500~10000 | major |
| 도산대로 | N-S | X:7800, Y:5500~7000 | medium |
| 천호대로 | E-W | Y:3200, X:11000~14400 | major |
| 송파대로 | N-S | X:10500, Y:5800~9000 | medium |
| 홍대거리 | N-S | X:2800, Y:2500~4800 | medium |
| 명동길 | N-S | X:6500, Y:3000~4200 | medium |
| 이태원로 | E-W | Y:4200, X:5500~7500 | medium |
| 서울로(서울역→남대문) | N-S | X:5600, Y:3600~4800 | medium |
| 올림픽로 | E-W | Y:7200, X:8500~12000 | major |
| 위례성대로 | E-W | Y:8500, X:9000~12000 | medium |

### 2C. 한강 다리 (14개, 서→동, 라벨 표시)
| # | 이름 | X좌표 (px) | 남북 연결 |
|---|------|-----------|-----------|
| 1 | 성산대교 | 1800 | 마포↔상암 |
| 2 | 양화대교 | 2400 | 합정↔영등포 |
| 3 | 서강대교 | 3200 | 서강↔여의도 |
| 4 | 마포대교 | 3800 | 마포↔여의도 |
| 5 | 원효대교 | 4600 | 원효↔여의도 |
| 6 | 한강대교 | 5200 | 용산↔노량진 |
| 7 | 동작대교 | 5800 | 동작↔동작 |
| 8 | 반포대교 | 6400 | 반포↔서초 |
| 9 | 한남대교 | 7200 | 한남↔강남 |
| 10 | 동호대교 | 7800 | 동호↔압구정 |
| 11 | 성수대교 | 8600 | 성수↔강남 |
| 12 | 영동대교 | 9200 | 뚝섬↔청담 |
| 13 | 청담대교 | 9800 | 청담↔삼성 |
| 14 | 잠실대교 | 10600 | 잠실↔잠실 |

---

## Phase 3: 서울 구역 재편 + 랜드마크 (14400×10800)

### 3A. 구역 확장 (4→8)
| 구역 | 위치 (px) | 크기 | 주요 콘텐츠 |
|------|-----------|------|------------|
| 홍대/마포 | (1200, 2400)~(4000, 4800) | 2800×2400 | 홍대거리, 연남동, 합정 카페 |
| 종로/광화문 | (4500, 1500)~(8500, 3200) | 4000×1700 | 경복궁, 광화문, 인사동, 북촌, DDP |
| 명동/남산 | (5800, 3200)~(8000, 4800) | 2200×1600 | 명동 상권, 남산타워, 서울역 |
| 이태원/용산 | (5200, 4200)~(7500, 5000) | 2300×800 | 이태원, 전쟁기념관, 용산역 |
| 여의도 | (2600, 5000)~(4200, 5700) | 1600×700 | 국회, IFC, 63빌딩 (한강 내 섬) |
| 강남/서초 | (5500, 5800)~(9500, 8500) | 4000×2700 | 강남역, 테헤란로, COEX, 압구정 |
| 성수/뚝섬 | (8500, 2500)~(11500, 5000) | 3000×2500 | 성수 카페거리, 뚝섬 한강공원 |
| 잠실/송파 | (9500, 5800)~(12500, 9000) | 3000×3200 | 롯데월드타워, 롯데월드, 석촌호수, 올림픽공원 |

### 3B. 서울 랜드마크 50개 (구글맵/트립닷컴/트립어드바이저 리뷰 종합순)

> 출처: [Trip.com 서울 베스트50](https://kr.trip.com/toplist/tripbest/seoul-best-things-to-do-100000001628/), [Tripadvisor 서울](https://www.tripadvisor.com/Attractions-g294197-Activities-Seoul.html), [Top-Rated.Online 서울](https://www.top-rated.online/countries/South+Korea/cities/Seoul/top-rated), [Wanderlog 서울 50선](https://wanderlog.com/ko/list/geoCategory/1813535/)

| # | 랜드마크 | 리뷰수 (근사) | 구역 | 좌표 (px) |
|---|----------|-------------|------|----------|
| 1 | N서울타워 (남산타워) | ~9,700 (Trip.com) | 남산 | (6800, 3800) |
| 2 | 경복궁 | ~11,000 (TA) | 종로 | (5600, 2000) |
| 3 | 명동 쇼핑거리 | ~10,500 (TA) | 명동 | (6600, 3400) |
| 4 | 롯데월드 어드벤처 | ~7,300 (연간) | 잠실 | (11000, 7200) |
| 5 | 롯데월드타워 서울스카이 | ~6,000+ | 잠실 | (10800, 6800) |
| 6 | 북촌 한옥마을 | ~5,500 (TA) | 종로 | (6200, 1800) |
| 7 | 남산공원 | ~2,250 (Trip) | 남산 | (6600, 4000) |
| 8 | COEX몰/스타필드 | ~4,500 | 강남 | (9200, 6800) |
| 9 | 광화문광장 | ~4,000 | 종로 | (5800, 2600) |
| 10 | 창덕궁/비원 | ~4,700 (TA) | 종로 | (6600, 1900) |
| 11 | 홍대 거리 | ~4,000 | 홍대 | (2800, 3500) |
| 12 | 청계천 | ~3,800 (TA) | 종로~성수 | (6000, 2700) |
| 13 | DDP 동대문디자인플라자 | ~3,500 | 종로 | (8200, 2900) |
| 14 | 전쟁기념관 | ~3,200 (TA) | 이태원 | (5800, 4500) |
| 15 | 국립중앙박물관 | ~3,000 (TA) | 이태원 | (6200, 4700) |
| 16 | 덕수궁 | ~2,800 | 종로 | (5800, 3000) |
| 17 | 인사동 거리 | ~2,500 | 종로 | (6000, 2400) |
| 18 | 여의도 한강공원 | ~2,400 | 여의도 | (3200, 5600) |
| 19 | 종묘 | ~2,200 (TA) | 종로 | (7000, 2400) |
| 20 | 광장시장 | ~2,100 | 종로 | (7200, 2800) |
| 21 | 이태원 거리 | ~2,000 | 이태원 | (6400, 4400) |
| 22 | 가로수길 | ~1,900 | 강남 | (7800, 6200) |
| 23 | 남대문시장 | ~1,800 | 명동 | (5800, 3700) |
| 24 | 석촌호수 | ~1,700 | 잠실 | (10500, 7600) |
| 25 | 서울숲 | ~1,600 | 성수 | (9200, 3800) |
| 26 | 창경궁 | ~1,500 | 종로 | (6800, 2000) |
| 27 | 올림픽공원 | ~1,400 | 송파 | (12000, 7800) |
| 28 | 서울역 | ~1,300 | 명동 | (5600, 4000) |
| 29 | 조계사 | ~1,200 | 종로 | (5800, 2400) |
| 30 | 국회의사당 | ~1,100 | 여의도 | (2900, 5200) |
| 31 | 여의도 IFC | ~1,000 | 여의도 | (3400, 5300) |
| 32 | 63빌딩/63스퀘어 | ~1,000 | 여의도 | (2800, 5500) |
| 33 | 뚝섬 한강공원 | ~950 | 성수 | (9500, 5000) |
| 34 | 성수동 카페거리 | ~900 | 성수 | (9500, 3500) |
| 35 | 삼청동 거리 | ~850 | 종로 | (6000, 1900) |
| 36 | 압구정/청담 거리 | ~800 | 강남 | (8000, 6000) |
| 37 | 명동성당 | ~750 | 명동 | (6500, 3400) |
| 38 | 연남동 경의선숲길 | ~700 | 홍대 | (2600, 2800) |
| 39 | 반포대교 달빛무지개분수 | ~650 | 한강 | (6400, 5600) |
| 40 | 이화벽화마을/대학로 | ~600 | 종로 | (7200, 2200) |
| 41 | 노량진 수산시장 | ~550 | 한강남 | (4800, 6000) |
| 42 | 코엑스 아쿠아리움 | ~500 | 강남 | (9200, 7000) |
| 43 | 잠실야구장 (잠실종합운동장) | ~480 | 잠실 | (10600, 7000) |
| 44 | 한양도성길 | ~450 | 종로 | (5400, 1600) |
| 45 | 월드컵경기장 | ~430 | 홍대 | (1800, 2600) |
| 46 | KBS 방송국 | ~400 | 여의도 | (3000, 5400) |
| 47 | 선릉/정릉 | ~380 | 강남 | (8600, 6600) |
| 48 | 노들섬 | ~350 | 한강 | (5200, 5300) |
| 49 | 세빛섬 | ~320 | 한강 | (6400, 5400) |
| 50 | 용산전자상가/아이파크몰 | ~300 | 이태원 | (5400, 4600) |

---

## Phase 4: 후쿠오카 맵 오버홀 (6400×4800 → 9600×7200)

### 4A. 지형 (9600×7200 스케일, ~640px/km)
| 지형 | 현재 | 개선 |
|------|------|------|
| 하카타만 | 직선 해안 Y<700 | 실제 만곡 해안선 (Y<1000, 곡선 폴리곤) |
| 나카가와 | 수직선 X:3400 | 곡선 경로 X:4800~5200 (하폭 변화 80~120px) |
| 무로미강 | 없음 | 서쪽 X:1500 부근, 남→북 흐름 |
| 미카사강 | 없음 | 나카가와 서쪽 합류, X:4200 |
| 오호리공원 | 없음 | (2200, 2800) 크기 800×600 호수+공원 |
| 노코섬 | 없음 | 하카타만 내 (3500, 400) 작은 섬 |

### 4B. 도로망 확장 (~15개)
| 도로명 | 방향 | 타입 |
|--------|------|------|
| 쇼와도리 (昭和通り) | E-W | major |
| 다이하쿠도리 (大博通り) | N-S | major |
| 와타나베도리 (渡辺通り) | N-S | major |
| 메이지도리 (明治通り) | E-W | major |
| 히에도리 (日枝通り) | E-W | medium |
| 하카타 에키마에도리 | N-S | medium |
| 텐진키타도리 | E-W | medium |
| 모모치도리 | E-W (해안가) | medium |
| 나카스 거리 | N-S | minor (나카가와 서안) |
| 하카타역 동쪽 도로 | N-S | medium |
| 국도3호선 (國道3號) | N-S | major |
| 니시테츠 고가 | E-W (텐진 위) | medium |

### 4C. 후쿠오카 랜드마크 25개 (구글맵 20주년 랭킹 + 리뷰 종합순)

> 출처: [Google Japan 20주년 47都道府県ランキング](https://blog.google/intl/ja-jp/products/explore-get-answers/google-maps-20th-localplaces-top5/), [楽天トラベル 福岡](https://travel.rakuten.co.jp/mytrip/ranking/spot-hakata), [RETRIP 福岡TOP30](https://rtrp.jp/locations/255/categories/9999/)

| # | 랜드마크 | 구역 | 좌표 (px, 9600×7200) |
|---|----------|------|---------------------|
| 1 | 쿠시다신사 (櫛田神社) | 하카타 | (5200, 3200) |
| 2 | 캐널시티 하카타 | 하카타 | (5400, 3600) |
| 3 | 후쿠오카타워 | 시사이드 | (1800, 1800) |
| 4 | PayPay돔 (미즈호) | 시사이드 | (1400, 2200) |
| 5 | 하카타역 / JR하카타시티 | 하카타 | (6200, 2800) |
| 6 | 나카스 야타이 (포장마차) | 나카스 | (4600, 3000) |
| 7 | 텐진 지하가 (天神地下街) | 텐진 | (3200, 2600) |
| 8 | 오호리공원 (大濠公園) | 오호리 | (2200, 2800) |
| 9 | BOSS E·ZO FUKUOKA | 시사이드 | (1500, 2000) |
| 10 | 하카타 리버레인 | 나카스 | (5000, 2800) |
| 11 | 텐진 코어/솔라리아 | 텐진 | (3400, 2400) |
| 12 | 마린메세 후쿠오카 | 해안가 | (6500, 1200) |
| 13 | 후쿠오카시 박물관 | 시사이드 | (2000, 2400) |
| 14 | 하카타좌 (博多座) | 나카스 | (4800, 2600) |
| 15 | 노코노시마 아일랜드파크 표지 | 해안 | (1000, 1000) |
| 16 | 아크로스 후쿠오카 | 텐진 | (3600, 2800) |
| 17 | 하카타 마치야 후루사토관 | 하카타 | (5400, 3000) |
| 18 | 후쿠오카 아시아미술관 | 나카스 | (4800, 3200) |
| 19 | 하카타 포트타워 | 해안가 | (6800, 1400) |
| 20 | 시사이드 모모치 해변 | 시사이드 | (1600, 1400) |
| 21 | 텐진중앙공원 | 텐진 | (3800, 3000) |
| 22 | 경의선숲길/케고공원 (警固公園) | 텐진 | (3600, 2200) |
| 23 | 라멘스타디움 (캐널시티) | 하카타 | (5600, 3600) |
| 24 | 하카타역 동쪽 출구 광장 | 하카타 | (6400, 2800) |
| 25 | 다자이후 방면 표지판 | 동남 | (8500, 5500) |

### 4D. 구역 확장 (3→5)
| 구역 | 위치 (px) | 크기 |
|------|-----------|------|
| 텐진 | (2600, 1800)~(4400, 3600) | 1800×1800 |
| 하카타 | (5400, 1800)~(7800, 4200) | 2400×2400 |
| 야쿠인 | (2600, 4000)~(4400, 6200) | 1800×2200 |
| 나카스 | (4400, 2400)~(5600, 4000) | 1200×1600 |
| 시사이드(모모치) | (1000, 1200)~(2600, 3000) | 1600×1800 |

---

## Phase 5: 차량 이동 시스템

### 5A. 상수 (`constants.js`)
```javascript
export const VEHICLE = {
  SELF_DRIVE_LEVEL: 6,     // 친구 차 빌려타기
  CHAUFFEUR_LEVEL: 10,     // 친구가 운전해줌
  SPEED: 1200,             // 이동 속도 (px/s, 일반 200의 6배)
  FRIEND_SEOUL: 'yuseok',  // 서울: 김유석
  FRIEND_FUKUOKA: 'dad',   // 후쿠오카: 아빠
};
```

### 5B. GameState 확장 (`GameState.js`)
```javascript
// 기존 current 객체에 추가
vehicleUsed: false,        // 차량 사용 이력
vehicleTripCount: 0,       // 탑승 횟수 (업적용)
```
- `canSelfDrive()` → level >= VEHICLE.SELF_DRIVE_LEVEL
- `canChauffeur()` → level >= VEHICLE.CHAUFFEUR_LEVEL

### 5C. UI — 차량 호출 버튼 (`BaseWorldScene.js`)
- **위치**: 인터랙트 버튼(COMM) 위쪽, 우하단
- **디자인**: HOBIS 스타일 — 시안 원형 아웃라인 + "RIDE" 라벨
- **상태**:
  - 레벨 미달: 🔒 + 반투명 (탭하면 "Lv.6에 해금됩니다" 메시지)
  - 셀프 가능: "RIDE" 시안 활성
  - 쇼퍼 가능: "RIDE+" 그린 활성
- `createVehicleButton()` — `createInteractButton()` 패턴 재사용

### 5D. 드라이브맵 오버레이 (`BaseWorldScene.js`)
- `showDriveMap()`:
  1. 게임 일시정지 (physics.pause)
  2. 카메라 줌아웃 → 전체 맵 표시 (0.15x~0.2x)
  3. 도로망 하이라이트 오버레이 (시안 라인)
  4. 현재 위치에 녹색 점, 터치 가능한 전체맵
  5. 사용자가 터치/클릭한 좌표를 목적지로 설정
- `executeDrive(destX, destY)`:
  1. 카메라 줌인 복귀
  2. 캐릭터가 VEHICLE.SPEED로 목적지까지 이동 (tween)
  3. 이동 중 화면 상단에 "DRIVING..." 표시
  4. 도착 시 정상 플레이 복귀

### 5E. 대사/연출
**서울 (김유석)**:
- 셀프: `"유석이 차 키를 빌렸다! / ユソクの車を借りた！"` → 맵 표시
- 쇼퍼: `"유석: 어디 가? 태워다 줄게! / ユソク: どこ行く？乗せてあげるよ！"` → 짧은 대사 후 맵

**후쿠오카 (아빠)**:
- 셀프: `"아빠 차를 빌렸다! / パパの車を借りた！"` → 맵 표시
- 쇼퍼: `"아빠: 어디 가니? 태워다줄게~ / パパ: どこ行くの？送ってあげるよ～"` → 대사 후 맵

---

## Phase 6: 건물 배치 정리

### 6A. 도로 위 건물 제거
- `_drawFillerBuildings()` 수정: 도로/물 영역 체크 후 건물 스킵
- `isOnRoad(x, y)` / `isOnWater(x, y)` 헬퍼 추가

### 6B. 건물 재배치
- 모든 인터랙션 건물을 도로 옆 블록 내부로 이동
- 지하철역 입구는 도로 옆 인도에 배치

---

## Phase 7: 검증

1. `npm run build` 에러 없음
2. 서울맵: 한강 S-커브 + 14개 다리 + 산악 지형 확인
3. 후쿠오카: 하카타만 + 나카가와 곡선 + 도로망 확인
4. 차량 호출 → 전체맵 → 터치 이동 동작 확인
5. 건물이 도로/물 위에 없는지 확인
6. 도로/다리에 이름 라벨 표시 확인
7. git commit + push → GitHub Pages 배포

---

## 구현 순서

1. **서울 지형** (Phase 1) — SeoulUnifiedScene.js 재작성
2. **서울 도로+다리** (Phase 2) — 도로 데이터 + 라벨
3. **서울 구역+랜드마크** (Phase 3) — 건물 재배치
4. **후쿠오카** (Phase 4) — FukuokaUnifiedScene.js 재작성
5. **차량 시스템** (Phase 5) — BaseWorldScene + GameState + constants
6. **건물 정리** (Phase 6) — 도로/물 위 건물 제거
7. **검증+배포** (Phase 7)

작업계획서를 `docs/20260301_XXXX_실제지리기반_맵리뉴얼_작업계획서.md`로 저장
